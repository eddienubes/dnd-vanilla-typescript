(()=>{"use strict";var t,e=function(){function t(t,e,n,r){this.templateElement=document.getElementById(t),this.hostElement=document.getElementById(e);var o=document.importNode(this.templateElement.content,!0);this.element=o.firstElementChild,r&&(this.element.id=r),this.attach(n)}return t.prototype.attach=function(t){this.hostElement.insertAdjacentElement(t?"afterbegin":"beforeend",this.element)},t}();function n(t){var e=!0;return t.required&&null!=t.value&&(e=e&&0!==t.value.toString().trim().length),null!=t.minLength&&"string"==typeof t.value&&(e=e&&t.value.trim().length>=t.minLength),null!=t.maxLength&&"string"==typeof t.value&&(e=e&&t.value.trim().length<=t.maxLength),null!=t.min&&"number"==typeof t.value&&(e=e&&t.value>=t.min),null!=t.max&&"number"==typeof t.value&&(e=e&&t.value<=t.max),e}function r(t,e,n){var r=n.value;return{enumerable:!0,configurable:!0,get:function(){return r.bind(this)}}}!function(t){t[t.Active=0]="Active",t[t.Finished=1]="Finished"}(t||(t={}));var o,i=function(t,e,n,r,o){this.id=t,this.title=e,this.description=n,this.people=r,this.status=o},l=(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),a=function(e){function n(){var t=e.call(this)||this;return t.projects=[],t.draggable=null,t}return l(n,e),Object.defineProperty(n.prototype,"currentDraggable",{get:function(){return Object.create(this.draggable)},set:function(t){this.draggable=Object.create(t)},enumerable:!1,configurable:!0}),n.prototype.addProject=function(e,n,r){var o=new i(Math.random().toString(),e,n,r,t.Active);this.projects.push(o);for(var l=0,a=this.listeners;l<a.length;l++)(0,a[l])(this.projects.slice())},n.getInstance=function(){return this.instance?this.instance:new n},n.prototype.moveProject=function(t,e){var n=this.projects.find((function(e){return e.id===t}));n&&n.status!==e&&(n.status=e,this.updateListeners())},n.prototype.updateListeners=function(){for(var t=0,e=this.listeners;t<e.length;t++)(0,e[t])(this.projects.slice())},n}(function(){function t(){this.listeners=[]}return t.prototype.addListener=function(t){this.listeners.push(t)},t}()).getInstance(),s=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),c=function(t){function e(){var e=t.call(this,"project-input","app",!0,"user-input")||this;return console.log("Rendered projects input!"),e.titleInputElement=e.element.querySelector("#title"),e.descriptionInputElement=e.element.querySelector("#description"),e.peopleInputElement=e.element.querySelector("#people"),e.configure(),e}return s(e,t),e.prototype.gatherUserInput=function(){var t=this.titleInputElement.value,e=this.descriptionInputElement.value,r=this.peopleInputElement.value,o={value:e,required:!0},i={value:+r,required:!0,min:2,max:6};return n({value:t,required:!0})&&n(o)&&n(i)?[t,e,+r]:void alert("Invalid input, please try again")},e.prototype.configure=function(){this.element.addEventListener("submit",this.submitHandler)},e.prototype.renderContent=function(){},e.prototype.submitHandler=function(t){t.preventDefault();var e=this.gatherUserInput();if(Array.isArray(e)){var n=e[0],r=e[1],o=e[2];a.addProject(n,r,o),this.clearInputs()}},e.prototype.clearInputs=function(){this.titleInputElement.value="",this.descriptionInputElement.value="",this.peopleInputElement.value=""},function(t,e,n,r){var o,i=arguments.length,l=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(l=(i<3?o(l):i>3?o(e,n,l):o(e,n))||l);i>3&&l&&Object.defineProperty(e,n,l)}([r],e.prototype,"submitHandler",null),e}(e),u=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),p=function(t,e,n,r){var o,i=arguments.length,l=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(l=(i<3?o(l):i>3?o(e,n,l):o(e,n))||l);return i>3&&l&&Object.defineProperty(e,n,l),l},f=function(t){function e(e,n){var r=t.call(this,"single-project",e,!1,n.id)||this;return r.project=n,r.configure(),r.renderContent(),r}return u(e,t),Object.defineProperty(e.prototype,"persons",{get:function(){return 1===this.project.people?"1 person":this.project.people+" persons"},enumerable:!1,configurable:!0}),e.prototype.configure=function(){this.element.addEventListener("dragstart",this.dragStartHandler),this.element.addEventListener("dragend",this.dragEndHandler)},e.prototype.renderContent=function(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=this.persons+" assigned",this.element.querySelector("p").textContent=this.project.description},e.prototype.dragStartHandler=function(t){t.dataTransfer.setData("text/plain",JSON.stringify({id:this.project.id,status:this.project.status})),t.dataTransfer.effectAllowed="move",a.currentDraggable=this.project},e.prototype.dragEndHandler=function(t){console.log("Drag has ended!"),a.currentDraggable=null},p([r],e.prototype,"dragStartHandler",null),p([r],e.prototype,"dragEndHandler",null),e}(e),d=function(){var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),h=function(t,e,n,r){var o,i=arguments.length,l=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)l=Reflect.decorate(t,e,n,r);else for(var a=t.length-1;a>=0;a--)(o=t[a])&&(l=(i<3?o(l):i>3?o(e,n,l):o(e,n))||l);return i>3&&l&&Object.defineProperty(e,n,l),l},y=function(e){function n(n){var r=e.call(this,"project-list","app",!1,(n===t.Active?"active":"finished")+"-projects")||this;return r.type=n,r.assignedProjects=[],console.log("Rendered projects list! ",n),r.configure(),r.renderContent(),r}return d(n,e),n.prototype.renderContent=function(){this.element.querySelector("ul").id=(this.type===t.Active?"active":"finished")+"-projects-list",this.element.querySelector("h2").textContent=t[this.type]+" PROJECTS"},n.prototype.configure=function(){var t=this;a.addListener((function(e){t.assignedProjects=e.filter((function(e){return e.status===t.type})),t.renderProjects()})),this.element.addEventListener("dragover",this.dragOverHandler),this.element.addEventListener("dragleave",this.dragLeaveHandler),this.element.addEventListener("drop",this.dropHandler),this.element.addEventListener("dragenter",this.dragEnterHandler)},n.prototype.renderProjects=function(){document.getElementById((this.type===t.Active?"active":"finished")+"-projects-list").innerHTML="";for(var e=0,n=this.assignedProjects;e<n.length;e++){var r=n[e];new f(this.element.querySelector("ul").id,r)}},n.prototype.dragOverHandler=function(t){t.dataTransfer&&"text/plain"===t.dataTransfer.types[0]&&(this.element.querySelector("ul").classList.add("droppable"),t.preventDefault())},n.prototype.dropHandler=function(t){var e=JSON.parse(t.dataTransfer.getData("text/plain")).id;a.moveProject(e,this.type),this.element.querySelector("ul").classList.remove("droppable")},n.prototype.dragLeaveHandler=function(t){this.element.querySelector("ul").classList.remove("droppable"),console.log("leave")},n.prototype.dragEnterHandler=function(t){t.preventDefault(),t.stopPropagation(),a.currentDraggable&&this.type!==a.currentDraggable.status&&t.preventDefault()},h([r],n.prototype,"dragOverHandler",null),h([r],n.prototype,"dropHandler",null),h([r],n.prototype,"dragLeaveHandler",null),h([r],n.prototype,"dragEnterHandler",null),n}(e);new c,new y(t.Active),new y(t.Finished)})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9iYXNlLWNvbXBvbmVudC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvbW9kZWxzL3Byb2plY3QudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10eXBlc2NyaXB0Ly4vc3JjL3V0aWwvdmFsaWRhdGlvbi50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvZGVjb3JhdG9ycy9hdXRvYmluZC50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvc3RhdGUvcHJvamVjdC1zdGF0ZS50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWlucHV0LnRzIiwid2VicGFjazovL3VuZGVyc3RhbmRpbmctdHlwZXNjcmlwdC8uL3NyYy9jb21wb25lbnRzL2xpc3QtaXRlbS50cyIsIndlYnBhY2s6Ly91bmRlcnN0YW5kaW5nLXR5cGVzY3JpcHQvLi9zcmMvY29tcG9uZW50cy9wcm9qZWN0LWxpc3QudHMiLCJ3ZWJwYWNrOi8vdW5kZXJzdGFuZGluZy10eXBlc2NyaXB0Ly4vc3JjL2FwcC50cyJdLCJuYW1lcyI6WyJQcm9qZWN0U3RhdHVzIiwidGVtcGxhdGVJZCIsImhvc3RFbGVtZW50SWQiLCJpbnNlcnRBdFN0YXJ0IiwibmV3RWxlbWVudElkIiwidGhpcyIsInRlbXBsYXRlRWxlbWVudCIsImRvY3VtZW50IiwiZ2V0RWxlbWVudEJ5SWQiLCJob3N0RWxlbWVudCIsImltcG9ydGVkTm9kZSIsImltcG9ydE5vZGUiLCJjb250ZW50IiwiZWxlbWVudCIsImZpcnN0RWxlbWVudENoaWxkIiwiaWQiLCJhdHRhY2giLCJpbnNlcnRBZGphY2VudEVsZW1lbnQiLCJ2YWxpZGF0ZSIsInZhbGlkYXRhYmxlIiwiaXNWYWxpZCIsInJlcXVpcmVkIiwidmFsdWUiLCJ0b1N0cmluZyIsInRyaW0iLCJsZW5ndGgiLCJtaW5MZW5ndGgiLCJtYXhMZW5ndGgiLCJtaW4iLCJtYXgiLCJGdW5jdGlvbkJpbmRlciIsIl8iLCJfMiIsImRlc2NyaXB0b3IiLCJvcmlnaW5hbEZuIiwiZW51bWVyYWJsZSIsImNvbmZpZ3VyYWJsZSIsImdldCIsImJpbmQiLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicGVvcGxlIiwic3RhdHVzIiwicHJvamVjdFN0YXRlIiwicHJvamVjdHMiLCJkcmFnZ2FibGUiLCJPYmplY3QiLCJjcmVhdGUiLCJhZGRQcm9qZWN0IiwibmV3UHJvamVjdCIsIlByb2plY3QiLCJNYXRoIiwicmFuZG9tIiwiQWN0aXZlIiwicHVzaCIsImxpc3RlbmVycyIsImxpc3RlbmVyIiwic2xpY2UiLCJnZXRJbnN0YW5jZSIsImluc3RhbmNlIiwiUHJvamVjdFN0YXRlIiwibW92ZVByb2plY3QiLCJwcm9qZWN0SWQiLCJuZXdTdGF0dXMiLCJwcmoiLCJmaW5kIiwicCIsInVwZGF0ZUxpc3RlbmVycyIsImFkZExpc3RlbmVyIiwiY29uc29sZSIsImxvZyIsInRpdGxlSW5wdXRFbGVtZW50IiwicXVlcnlTZWxlY3RvciIsImRlc2NyaXB0aW9uSW5wdXRFbGVtZW50IiwicGVvcGxlSW5wdXRFbGVtZW50IiwiY29uZmlndXJlIiwiZ2F0aGVyVXNlcklucHV0IiwiZGVzY3JpcHRpb25WYWxpZGF0YWJsZSIsInBlb3BsZVZhbGlkYXRhYmxlIiwiYWxlcnQiLCJhZGRFdmVudExpc3RlbmVyIiwic3VibWl0SGFuZGxlciIsInJlbmRlckNvbnRlbnQiLCJldmVudCIsInByZXZlbnREZWZhdWx0IiwidXNlcklucHV0IiwiQXJyYXkiLCJpc0FycmF5IiwiY2xlYXJJbnB1dHMiLCJDb21wb25lbnQiLCJob3N0SWQiLCJwcm9qZWN0IiwiZHJhZ1N0YXJ0SGFuZGxlciIsImRyYWdFbmRIYW5kbGVyIiwidGV4dENvbnRlbnQiLCJwZXJzb25zIiwiZGF0YVRyYW5zZmVyIiwic2V0RGF0YSIsIkpTT04iLCJzdHJpbmdpZnkiLCJlZmZlY3RBbGxvd2VkIiwiY3VycmVudERyYWdnYWJsZSIsInR5cGUiLCJhc3NpZ25lZFByb2plY3RzIiwiZmlsdGVyIiwicmVuZGVyUHJvamVjdHMiLCJkcmFnT3ZlckhhbmRsZXIiLCJkcmFnTGVhdmVIYW5kbGVyIiwiZHJvcEhhbmRsZXIiLCJkcmFnRW50ZXJIYW5kbGVyIiwiaW5uZXJIVE1MIiwicHJqSXRlbSIsIkxpc3RJdGVtIiwidHlwZXMiLCJjbGFzc0xpc3QiLCJhZGQiLCJwYXJzZSIsImdldERhdGEiLCJyZW1vdmUiLCJzdG9wUHJvcGFnYXRpb24iLCJQcm9qZWN0SW5wdXQiLCJQcm9qZWN0TGlzdCIsIkZpbmlzaGVkIl0sIm1hcHBpbmdzIjoibUJBQ0EsSUNBWUEsRURBWixhQUtFLFdBQ0VDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBRUFDLEtBQUtDLGdCQUFrQkMsU0FBU0MsZUFBZVAsR0FDL0NJLEtBQUtJLFlBQWNGLFNBQVNDLGVBQWVOLEdBRTNDLElBQU1RLEVBQWVILFNBQVNJLFdBQVdOLEtBQUtDLGdCQUFnQk0sU0FBUyxHQUV2RVAsS0FBS1EsUUFBVUgsRUFBYUksa0JBQ3hCVixJQUNGQyxLQUFLUSxRQUFRRSxHQUFLWCxHQUdwQkMsS0FBS1csT0FBT2IsR0FVaEIsT0FQRSxZQUFBYSxPQUFBLFNBQU9iLEdBQ0xFLEtBQUtJLFlBQVlRLHNCQUFzQmQsRUFBZ0IsYUFBZSxZQUFhRSxLQUFLUSxVQU01RixFQS9CQSxHRUVPLFNBQVNLLEVBQVNDLEdBQ3ZCLElBQUlDLEdBQVUsRUFxQmQsT0FwQklELEVBQVlFLFVBQWlDLE1BQXJCRixFQUFZRyxRQUN0Q0YsRUFBVUEsR0FBMEQsSUFBL0NELEVBQVlHLE1BQU1DLFdBQVdDLE9BQU9DLFFBRzlCLE1BQXpCTixFQUFZTyxXQUFrRCxpQkFBdEJQLEVBQVlHLFFBQ3RERixFQUFVQSxHQUFXRCxFQUFZRyxNQUFNRSxPQUFPQyxRQUFVTixFQUFZTyxXQUd6QyxNQUF6QlAsRUFB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SUFBSUMsRUFBWXpILEVBQWNxRCxRQUM1QixJQUFJb0UsRUFBWXpILEVBQWMwSCxXIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vIENvbXBvbmVudCBiYXNlIGNsYXNzXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBDb21wb25lbnQ8VCBleHRlbmRzIEhUTUxFbGVtZW50LCBVIGV4dGVuZHMgSFRNTEVsZW1lbnQ+IHtcclxuICB0ZW1wbGF0ZUVsZW1lbnQ6IEhUTUxUZW1wbGF0ZUVsZW1lbnQ7XHJcbiAgaG9zdEVsZW1lbnQ6IFQ7XHJcbiAgZWxlbWVudDogVTtcclxuXHJcbiAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKFxyXG4gICAgdGVtcGxhdGVJZDogc3RyaW5nLFxyXG4gICAgaG9zdEVsZW1lbnRJZDogc3RyaW5nLFxyXG4gICAgaW5zZXJ0QXRTdGFydDogYm9vbGVhbixcclxuICAgIG5ld0VsZW1lbnRJZD86IHN0cmluZ1xyXG4gICkge1xyXG4gICAgdGhpcy50ZW1wbGF0ZUVsZW1lbnQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh0ZW1wbGF0ZUlkKSBhcyBIVE1MVGVtcGxhdGVFbGVtZW50O1xyXG4gICAgdGhpcy5ob3N0RWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGhvc3RFbGVtZW50SWQpIGFzIFQ7XHJcblxyXG4gICAgY29uc3QgaW1wb3J0ZWROb2RlID0gZG9jdW1lbnQuaW1wb3J0Tm9kZSh0aGlzLnRlbXBsYXRlRWxlbWVudC5jb250ZW50LCB0cnVlKTtcclxuXHJcbiAgICB0aGlzLmVsZW1lbnQgPSBpbXBvcnRlZE5vZGUuZmlyc3RFbGVtZW50Q2hpbGQgYXMgVTtcclxuICAgIGlmIChuZXdFbGVtZW50SWQpIHtcclxuICAgICAgdGhpcy5lbGVtZW50LmlkID0gbmV3RWxlbWVudElkO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuYXR0YWNoKGluc2VydEF0U3RhcnQpO1xyXG4gIH1cclxuXHJcbiAgYXR0YWNoKGluc2VydEF0U3RhcnQ6IGJvb2xlYW4pIHtcclxuICAgIHRoaXMuaG9zdEVsZW1lbnQuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KGluc2VydEF0U3RhcnQgPyAnYWZ0ZXJiZWdpbicgOiAnYmVmb3JlZW5kJywgdGhpcy5lbGVtZW50KTtcclxuICB9XHJcblxyXG4gIGFic3RyYWN0IHJlbmRlckNvbnRlbnQoKTogdm9pZDtcclxuXHJcbiAgYWJzdHJhY3QgY29uZmlndXJlKCk6IHZvaWQ7XHJcbn1cclxuXHJcblxyXG5cclxuIiwiLy8gZW51bSBmb3IgcHJvamVjdCBzdGF0dXNcclxuZXhwb3J0IGVudW0gUHJvamVjdFN0YXR1cyB7XHJcbiAgQWN0aXZlLFxyXG4gIEZpbmlzaGVkXHJcbn1cclxuXHJcbi8vIFByb2plY3QgY2xhc3NcclxuZXhwb3J0IGNsYXNzIFByb2plY3Qge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIGlkOiBzdHJpbmcsXHJcbiAgICBwdWJsaWMgdGl0bGU6IHN0cmluZyxcclxuICAgIHB1YmxpYyBkZXNjcmlwdGlvbjogc3RyaW5nLFxyXG4gICAgcHVibGljIHBlb3BsZTogbnVtYmVyLFxyXG4gICAgcHVibGljIHN0YXR1czogUHJvamVjdFN0YXR1c1xyXG4gICkge1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQge0lWYWxpZGF0YWJsZX0gZnJvbSBcIi4uL21vZGVscy92YWxpZGF0aW9uXCI7XHJcblxyXG4vLyB2YWxpZGF0aW9uXHJcbmV4cG9ydCBmdW5jdGlvbiB2YWxpZGF0ZSh2YWxpZGF0YWJsZTogSVZhbGlkYXRhYmxlKSB7XHJcbiAgbGV0IGlzVmFsaWQgPSB0cnVlO1xyXG4gIGlmICh2YWxpZGF0YWJsZS5yZXF1aXJlZCAmJiB2YWxpZGF0YWJsZS52YWx1ZSAhPSBudWxsKSB7XHJcbiAgICBpc1ZhbGlkID0gaXNWYWxpZCAmJiB2YWxpZGF0YWJsZS52YWx1ZS50b1N0cmluZygpLnRyaW0oKS5sZW5ndGggIT09IDA7XHJcbiAgfVxyXG5cclxuICBpZiAodmFsaWRhdGFibGUubWluTGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlLnZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGUudmFsdWUudHJpbSgpLmxlbmd0aCA+PSB2YWxpZGF0YWJsZS5taW5MZW5ndGg7XHJcbiAgfVxyXG5cclxuICBpZiAodmFsaWRhdGFibGUubWF4TGVuZ3RoICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlLnZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGUudmFsdWUudHJpbSgpLmxlbmd0aCA8PSB2YWxpZGF0YWJsZS5tYXhMZW5ndGg7XHJcbiAgfVxyXG5cclxuICBpZiAodmFsaWRhdGFibGUubWluICE9IG51bGwgJiYgdHlwZW9mIHZhbGlkYXRhYmxlLnZhbHVlID09PSAnbnVtYmVyJykge1xyXG4gICAgaXNWYWxpZCA9IGlzVmFsaWQgJiYgdmFsaWRhdGFibGUudmFsdWUgPj0gdmFsaWRhdGFibGUubWluO1xyXG4gIH1cclxuXHJcbiAgaWYgKHZhbGlkYXRhYmxlLm1heCAhPSBudWxsICYmIHR5cGVvZiB2YWxpZGF0YWJsZS52YWx1ZSA9PT0gJ251bWJlcicpIHtcclxuICAgIGlzVmFsaWQgPSBpc1ZhbGlkICYmIHZhbGlkYXRhYmxlLnZhbHVlIDw9IHZhbGlkYXRhYmxlLm1heDtcclxuICB9XHJcblxyXG4gIHJldHVybiBpc1ZhbGlkO1xyXG59XHJcblxyXG4iLCIvL2F1dG9iaW5kIGRlY29yYXRvclxyXG5leHBvcnQgZnVuY3Rpb24gRnVuY3Rpb25CaW5kZXIoXzogYW55LCBfMjogc3RyaW5nLCBkZXNjcmlwdG9yOiBQcm9wZXJ0eURlc2NyaXB0b3IpOiBQcm9wZXJ0eURlc2NyaXB0b3Ige1xyXG4gIGNvbnN0IG9yaWdpbmFsRm4gPSBkZXNjcmlwdG9yLnZhbHVlO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgZW51bWVyYWJsZTogdHJ1ZSxcclxuICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcclxuICAgIGdldCgpIHtcclxuICAgICAgcmV0dXJuIG9yaWdpbmFsRm4uYmluZCh0aGlzKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbiIsImltcG9ydCB7UHJvamVjdH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XHJcbmltcG9ydCB7UHJvamVjdFN0YXR1c30gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XHJcblxyXG4vLyB0eXBlIExpc3RlbmVyID0gKGl0ZW1zKSA9PiB2b2lkXHJcbnR5cGUgTGlzdGVuZXI8VD4gPSAoaXRlbXM6IFRbXSkgPT4gdm9pZDtcclxuXHJcbi8vIEJhc2UgY2xhc3MgZm9yIHN0YXRlIG1hbmFnZW1lbnRcclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFN0YXRlPFQ+IHtcclxuICBwcm90ZWN0ZWQgbGlzdGVuZXJzOiBMaXN0ZW5lcjxUPltdID0gW107XHJcblxyXG4gIHByb3RlY3RlZCBjb25zdHJ1Y3RvcigpIHtcclxuICB9XHJcblxyXG4gIGFkZExpc3RlbmVyKGxpc3RlbmVyOiBMaXN0ZW5lcjxUPikge1xyXG4gICAgdGhpcy5saXN0ZW5lcnMucHVzaChsaXN0ZW5lcik7XHJcbiAgfVxyXG5cclxufVxyXG5cclxuLy8gUHJvamVjdCBTdGF0ZSBNYW5hZ2VtZW50IGNsYXNzXHJcbmV4cG9ydCBjbGFzcyBQcm9qZWN0U3RhdGUgZXh0ZW5kcyBTdGF0ZTxQcm9qZWN0PiB7XHJcbiAgcHJpdmF0ZSBwcm9qZWN0czogUHJvamVjdFtdID0gW107XHJcbiAgcHJpdmF0ZSBzdGF0aWMgaW5zdGFuY2U6IFByb2plY3RTdGF0ZTtcclxuICBwcml2YXRlIGRyYWdnYWJsZTogUHJvamVjdCB8IG51bGwgPSBudWxsO1xyXG5cclxuICBnZXQgY3VycmVudERyYWdnYWJsZSgpIHtcclxuICAgIHJldHVybiBPYmplY3QuY3JlYXRlKHRoaXMuZHJhZ2dhYmxlKTtcclxuICB9XHJcblxyXG4gIHNldCBjdXJyZW50RHJhZ2dhYmxlKHZhbHVlOiBQcm9qZWN0IHwgbnVsbCkge1xyXG4gICAgdGhpcy5kcmFnZ2FibGUgPSBPYmplY3QuY3JlYXRlKHZhbHVlKTtcclxuICB9XHJcblxyXG4gIHByaXZhdGUgY29uc3RydWN0b3IoKSB7XHJcbiAgICBzdXBlcigpO1xyXG4gIH1cclxuXHJcbiAgYWRkUHJvamVjdCh0aXRsZTogc3RyaW5nLCBkZXNjcmlwdGlvbjogc3RyaW5nLCBwZW9wbGU6IG51bWJlcikge1xyXG4gICAgY29uc3QgbmV3UHJvamVjdCA9IG5ldyBQcm9qZWN0KE1hdGgucmFuZG9tKCkudG9TdHJpbmcoKSwgdGl0bGUsIGRlc2NyaXB0aW9uLCBwZW9wbGUsIFByb2plY3RTdGF0dXMuQWN0aXZlKTtcclxuXHJcbiAgICB0aGlzLnByb2plY3RzLnB1c2gobmV3UHJvamVjdCk7XHJcbiAgICBmb3IgKGNvbnN0IGxpc3RlbmVyIG9mIHRoaXMubGlzdGVuZXJzKSB7XHJcbiAgICAgIGxpc3RlbmVyKHRoaXMucHJvamVjdHMuc2xpY2UoKSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKSB7XHJcbiAgICBpZiAodGhpcy5pbnN0YW5jZSkge1xyXG4gICAgICByZXR1cm4gdGhpcy5pbnN0YW5jZTtcclxuICAgIH1cclxuICAgIHJldHVybiBuZXcgUHJvamVjdFN0YXRlKCk7XHJcbiAgfVxyXG5cclxuICBtb3ZlUHJvamVjdChwcm9qZWN0SWQ6IHN0cmluZywgbmV3U3RhdHVzOiBQcm9qZWN0U3RhdHVzKSB7XHJcbiAgICBjb25zdCBwcmogPSB0aGlzLnByb2plY3RzLmZpbmQocCA9PiBwLmlkID09PSBwcm9qZWN0SWQpO1xyXG5cclxuICAgIGlmIChwcmogJiYgcHJqLnN0YXR1cyAhPT0gbmV3U3RhdHVzKSB7XHJcbiAgICAgIHByai5zdGF0dXMgPSBuZXdTdGF0dXM7XHJcbiAgICAgIHRoaXMudXBkYXRlTGlzdGVuZXJzKCk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHVwZGF0ZUxpc3RlbmVycygpIHtcclxuICAgIGZvciAoY29uc3QgbGlzdGVuZXIgb2YgdGhpcy5saXN0ZW5lcnMpIHtcclxuICAgICAgbGlzdGVuZXIodGhpcy5wcm9qZWN0cy5zbGljZSgpKTtcclxuICAgIH1cclxuICB9XHJcblxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcHJvamVjdFN0YXRlID0gUHJvamVjdFN0YXRlLmdldEluc3RhbmNlKCk7XHJcblxyXG4iLCJpbXBvcnQge0NvbXBvbmVudH0gZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IHtJVmFsaWRhdGFibGV9IGZyb20gXCIuLi9tb2RlbHMvdmFsaWRhdGlvblwiO1xyXG5pbXBvcnQge3ZhbGlkYXRlfSBmcm9tIFwiLi4vdXRpbC92YWxpZGF0aW9uXCI7XHJcbmltcG9ydCB7RnVuY3Rpb25CaW5kZXJ9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XHJcbmltcG9ydCB7cHJvamVjdFN0YXRlfSBmcm9tIFwiLi4vc3RhdGUvcHJvamVjdC1zdGF0ZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RJbnB1dCBleHRlbmRzIENvbXBvbmVudDxIVE1MRGl2RWxlbWVudCwgSFRNTEZvcm1FbGVtZW50PiB7XHJcbiAgdGl0bGVJbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQ6IEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgcGVvcGxlSW5wdXRFbGVtZW50OiBIVE1MSW5wdXRFbGVtZW50O1xyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKCdwcm9qZWN0LWlucHV0JywgJ2FwcCcsIHRydWUsICd1c2VyLWlucHV0Jyk7XHJcbiAgICBjb25zb2xlLmxvZygnUmVuZGVyZWQgcHJvamVjdHMgaW5wdXQhJyk7XHJcbiAgICB0aGlzLnRpdGxlSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyN0aXRsZScpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICB0aGlzLmRlc2NyaXB0aW9uSW5wdXRFbGVtZW50ID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJyNkZXNjcmlwdGlvbicpIGFzIEhUTUxJbnB1dEVsZW1lbnQ7XHJcbiAgICB0aGlzLnBlb3BsZUlucHV0RWxlbWVudCA9IHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcjcGVvcGxlJykgYXMgSFRNTElucHV0RWxlbWVudDtcclxuXHJcbiAgICB0aGlzLmNvbmZpZ3VyZSgpO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBnYXRoZXJVc2VySW5wdXQoKTogW3N0cmluZywgc3RyaW5nLCBudW1iZXJdIHwgdm9pZCB7XHJcbiAgICBjb25zdCB0aXRsZSA9IHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWU7XHJcbiAgICBjb25zdCBkZXNjcmlwdGlvbiA9IHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWU7XHJcbiAgICBjb25zdCBwZW9wbGUgPSB0aGlzLnBlb3BsZUlucHV0RWxlbWVudC52YWx1ZTtcclxuXHJcbiAgICBjb25zdCB0aXRsZVZhbGlkYXRhYmxlOiBJVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgIHZhbHVlOiB0aXRsZSxcclxuICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBkZXNjcmlwdGlvblZhbGlkYXRhYmxlOiBJVmFsaWRhdGFibGUgPSB7XHJcbiAgICAgIHZhbHVlOiBkZXNjcmlwdGlvbixcclxuICAgICAgcmVxdWlyZWQ6IHRydWVcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBwZW9wbGVWYWxpZGF0YWJsZTogSVZhbGlkYXRhYmxlID0ge1xyXG4gICAgICB2YWx1ZTogK3Blb3BsZSxcclxuICAgICAgcmVxdWlyZWQ6IHRydWUsXHJcbiAgICAgIG1pbjogMixcclxuICAgICAgbWF4OiA2XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKFxyXG4gICAgICAhdmFsaWRhdGUodGl0bGVWYWxpZGF0YWJsZSkgfHxcclxuICAgICAgIXZhbGlkYXRlKGRlc2NyaXB0aW9uVmFsaWRhdGFibGUpIHx8XHJcbiAgICAgICF2YWxpZGF0ZShwZW9wbGVWYWxpZGF0YWJsZSlcclxuICAgICkge1xyXG4gICAgICBhbGVydCgnSW52YWxpZCBpbnB1dCwgcGxlYXNlIHRyeSBhZ2FpbicpO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gW3RpdGxlLCBkZXNjcmlwdGlvbiwgK3Blb3BsZV07XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25maWd1cmUoKSB7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignc3VibWl0JywgdGhpcy5zdWJtaXRIYW5kbGVyKTtcclxuICB9XHJcblxyXG4gIHJlbmRlckNvbnRlbnQoKSB7XHJcbiAgfVxyXG5cclxuICBARnVuY3Rpb25CaW5kZXJcclxuICBwcml2YXRlIHN1Ym1pdEhhbmRsZXIoZXZlbnQ6IEV2ZW50KSB7XHJcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc3QgdXNlcklucHV0ID0gdGhpcy5nYXRoZXJVc2VySW5wdXQoKTtcclxuXHJcbiAgICBpZiAoQXJyYXkuaXNBcnJheSh1c2VySW5wdXQpKSB7XHJcbiAgICAgIGNvbnN0IFt0aXRsZSwgZGVzY3JpcHRpb24sIHBlb3BsZV0gPSB1c2VySW5wdXQ7XHJcbiAgICAgIHByb2plY3RTdGF0ZS5hZGRQcm9qZWN0KHRpdGxlLCBkZXNjcmlwdGlvbiwgcGVvcGxlKTtcclxuICAgICAgdGhpcy5jbGVhcklucHV0cygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBjbGVhcklucHV0cygpIHtcclxuICAgIHRoaXMudGl0bGVJbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcclxuICAgIHRoaXMuZGVzY3JpcHRpb25JbnB1dEVsZW1lbnQudmFsdWUgPSAnJztcclxuICAgIHRoaXMucGVvcGxlSW5wdXRFbGVtZW50LnZhbHVlID0gJyc7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7Q29tcG9uZW50fSBmcm9tIFwiLi9iYXNlLWNvbXBvbmVudFwiO1xyXG5pbXBvcnQge0lEcmFnZ2FibGV9IGZyb20gXCIuLi9tb2RlbHMvZG5kXCI7XHJcbmltcG9ydCB7UHJvamVjdH0gZnJvbSBcIi4uL21vZGVscy9wcm9qZWN0XCI7XHJcbmltcG9ydCB7RnVuY3Rpb25CaW5kZXJ9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XHJcbmltcG9ydCB7cHJvamVjdFN0YXRlfSBmcm9tIFwiLi4vc3RhdGUvcHJvamVjdC1zdGF0ZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIExpc3RJdGVtIGV4dGVuZHMgQ29tcG9uZW50PEhUTUxVTGlzdEVsZW1lbnQsIEhUTUxMSUVsZW1lbnQ+IGltcGxlbWVudHMgSURyYWdnYWJsZSB7XHJcbiAgcHJpdmF0ZSByZWFkb25seSBwcm9qZWN0OiBQcm9qZWN0O1xyXG5cclxuICBwcml2YXRlIGdldCBwZXJzb25zKCkge1xyXG4gICAgaWYgKHRoaXMucHJvamVjdC5wZW9wbGUgPT09IDEpIHtcclxuICAgICAgcmV0dXJuICcxIHBlcnNvbic7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gYCR7dGhpcy5wcm9qZWN0LnBlb3BsZX0gcGVyc29uc2A7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3Rvcihob3N0SWQ6IHN0cmluZywgcHJvamVjdDogUHJvamVjdCkge1xyXG4gICAgc3VwZXIoJ3NpbmdsZS1wcm9qZWN0JywgaG9zdElkLCBmYWxzZSwgcHJvamVjdC5pZCk7XHJcbiAgICB0aGlzLnByb2plY3QgPSBwcm9qZWN0O1xyXG4gICAgdGhpcy5jb25maWd1cmUoKTtcclxuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xyXG4gIH1cclxuXHJcbiAgY29uZmlndXJlKCkge1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIHRoaXMuZHJhZ1N0YXJ0SGFuZGxlcik7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsIHRoaXMuZHJhZ0VuZEhhbmRsZXIpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMicpIS50ZXh0Q29udGVudCA9IHRoaXMucHJvamVjdC50aXRsZTtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCdoMycpIS50ZXh0Q29udGVudCA9IHRoaXMucGVyc29ucyArICcgYXNzaWduZWQnO1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3AnKSEudGV4dENvbnRlbnQgPSB0aGlzLnByb2plY3QuZGVzY3JpcHRpb247XHJcbiAgfVxyXG5cclxuICBARnVuY3Rpb25CaW5kZXJcclxuICBkcmFnU3RhcnRIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgIGV2ZW50LmRhdGFUcmFuc2ZlciEuc2V0RGF0YSgndGV4dC9wbGFpbicsIEpTT04uc3RyaW5naWZ5KHtpZDogdGhpcy5wcm9qZWN0LmlkLCBzdGF0dXM6IHRoaXMucHJvamVjdC5zdGF0dXN9KSk7XHJcbiAgICBldmVudC5kYXRhVHJhbnNmZXIhLmVmZmVjdEFsbG93ZWQgPSAnbW92ZSc7XHJcbiAgICBwcm9qZWN0U3RhdGUuY3VycmVudERyYWdnYWJsZSA9IHRoaXMucHJvamVjdDtcclxuICB9XHJcblxyXG4gIEBGdW5jdGlvbkJpbmRlclxyXG4gIGRyYWdFbmRIYW5kbGVyKF86IERyYWdFdmVudCkge1xyXG4gICAgY29uc29sZS5sb2coJ0RyYWcgaGFzIGVuZGVkIScpO1xyXG4gICAgcHJvamVjdFN0YXRlLmN1cnJlbnREcmFnZ2FibGUgPSBudWxsO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQge0NvbXBvbmVudH0gZnJvbSBcIi4vYmFzZS1jb21wb25lbnRcIjtcclxuaW1wb3J0IHtJRHJhZ1RhcmdldH0gZnJvbSBcIi4uL21vZGVscy9kbmRcIjtcclxuaW1wb3J0IHtQcm9qZWN0fSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuaW1wb3J0IHtQcm9qZWN0U3RhdHVzfSBmcm9tIFwiLi4vbW9kZWxzL3Byb2plY3RcIjtcclxuaW1wb3J0IHtMaXN0SXRlbX0gZnJvbSBcIi4vbGlzdC1pdGVtXCI7XHJcbmltcG9ydCB7RnVuY3Rpb25CaW5kZXJ9IGZyb20gXCIuLi9kZWNvcmF0b3JzL2F1dG9iaW5kXCI7XHJcbmltcG9ydCB7cHJvamVjdFN0YXRlfSBmcm9tIFwiLi4vc3RhdGUvcHJvamVjdC1zdGF0ZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFByb2plY3RMaXN0IGV4dGVuZHMgQ29tcG9uZW50PEhUTUxEaXZFbGVtZW50LCBIVE1MRWxlbWVudD4gaW1wbGVtZW50cyBJRHJhZ1RhcmdldCB7XHJcbiAgYXNzaWduZWRQcm9qZWN0czogUHJvamVjdFtdO1xyXG5cclxuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHR5cGU6IFByb2plY3RTdGF0dXMpIHtcclxuICAgIHN1cGVyKCdwcm9qZWN0LWxpc3QnLCAnYXBwJywgZmFsc2UsIGAke3R5cGUgPT09IFByb2plY3RTdGF0dXMuQWN0aXZlID8gJ2FjdGl2ZScgOiAnZmluaXNoZWQnfS1wcm9qZWN0c2ApO1xyXG4gICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gW107XHJcbiAgICBjb25zb2xlLmxvZygnUmVuZGVyZWQgcHJvamVjdHMgbGlzdCEgJywgdHlwZSk7XHJcblxyXG4gICAgdGhpcy5jb25maWd1cmUoKTtcclxuICAgIHRoaXMucmVuZGVyQ29udGVudCgpO1xyXG4gIH1cclxuXHJcbiAgcmVuZGVyQ29udGVudCgpIHtcclxuICAgIHRoaXMuZWxlbWVudC5xdWVyeVNlbGVjdG9yKCd1bCcpIS5pZCA9IGAke3RoaXMudHlwZSA9PT0gUHJvamVjdFN0YXR1cy5BY3RpdmUgPyAnYWN0aXZlJyA6ICdmaW5pc2hlZCd9LXByb2plY3RzLWxpc3RgO1xyXG4gICAgdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ2gyJykhLnRleHRDb250ZW50ID0gUHJvamVjdFN0YXR1c1t0aGlzLnR5cGVdICsgJyBQUk9KRUNUUyc7XHJcbiAgfVxyXG5cclxuICBjb25maWd1cmUoKSB7XHJcbiAgICBwcm9qZWN0U3RhdGUuYWRkTGlzdGVuZXIoKHByb2plY3RzOiBQcm9qZWN0W10pID0+IHtcclxuICAgICAgdGhpcy5hc3NpZ25lZFByb2plY3RzID0gcHJvamVjdHMuZmlsdGVyKHAgPT4ge1xyXG4gICAgICAgIHJldHVybiBwLnN0YXR1cyA9PT0gdGhpcy50eXBlO1xyXG4gICAgICB9KTtcclxuICAgICAgdGhpcy5yZW5kZXJQcm9qZWN0cygpO1xyXG4gICAgfSk7XHJcblxyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgdGhpcy5kcmFnT3ZlckhhbmRsZXIpO1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdsZWF2ZScsIHRoaXMuZHJhZ0xlYXZlSGFuZGxlcik7XHJcbiAgICB0aGlzLmVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZHJvcCcsIHRoaXMuZHJvcEhhbmRsZXIpO1xyXG4gICAgdGhpcy5lbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIHRoaXMuZHJhZ0VudGVySGFuZGxlcik7XHJcbiAgfVxyXG5cclxuICBwcml2YXRlIHJlbmRlclByb2plY3RzKCkge1xyXG4gICAgY29uc3QgbGlzdEVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYCR7dGhpcy50eXBlID09PSBQcm9qZWN0U3RhdHVzLkFjdGl2ZSA/ICdhY3RpdmUnIDogJ2ZpbmlzaGVkJ30tcHJvamVjdHMtbGlzdGApIGFzIEhUTUxFbGVtZW50O1xyXG4gICAgbGlzdEVsLmlubmVySFRNTCA9ICcnO1xyXG4gICAgZm9yIChjb25zdCBwcmpJdGVtIG9mIHRoaXMuYXNzaWduZWRQcm9qZWN0cykge1xyXG4gICAgICBuZXcgTGlzdEl0ZW0odGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykhLmlkLCBwcmpJdGVtKVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQEZ1bmN0aW9uQmluZGVyXHJcbiAgZHJhZ092ZXJIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgIGlmIChldmVudC5kYXRhVHJhbnNmZXIgJiYgZXZlbnQuZGF0YVRyYW5zZmVyLnR5cGVzWzBdID09PSAndGV4dC9wbGFpbicpIHtcclxuICAgICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuICAgICAgbGlzdEVsLmNsYXNzTGlzdC5hZGQoJ2Ryb3BwYWJsZScpO1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgQEZ1bmN0aW9uQmluZGVyXHJcbiAgZHJvcEhhbmRsZXIoZXZlbnQ6IERyYWdFdmVudCkge1xyXG4gICAgY29uc3Qge2lkfSA9IEpTT04ucGFyc2UoZXZlbnQuZGF0YVRyYW5zZmVyIS5nZXREYXRhKCd0ZXh0L3BsYWluJykpO1xyXG4gICAgcHJvamVjdFN0YXRlLm1vdmVQcm9qZWN0KGlkLCB0aGlzLnR5cGUpO1xyXG4gICAgY29uc3QgbGlzdEVsID0gdGhpcy5lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJ3VsJykgYXMgSFRNTFVMaXN0RWxlbWVudDtcclxuICAgIGxpc3RFbC5jbGFzc0xpc3QucmVtb3ZlKCdkcm9wcGFibGUnKTtcclxuICB9XHJcblxyXG4gIEBGdW5jdGlvbkJpbmRlclxyXG4gIGRyYWdMZWF2ZUhhbmRsZXIoXzogRHJhZ0V2ZW50KSB7XHJcbiAgICBjb25zdCBsaXN0RWwgPSB0aGlzLmVsZW1lbnQucXVlcnlTZWxlY3RvcigndWwnKSBhcyBIVE1MVUxpc3RFbGVtZW50O1xyXG4gICAgbGlzdEVsLmNsYXNzTGlzdC5yZW1vdmUoJ2Ryb3BwYWJsZScpO1xyXG4gICAgY29uc29sZS5sb2coJ2xlYXZlJyk7XHJcbiAgfVxyXG5cclxuICBARnVuY3Rpb25CaW5kZXJcclxuICBkcmFnRW50ZXJIYW5kbGVyKGV2ZW50OiBEcmFnRXZlbnQpIHtcclxuICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICBldmVudC5zdG9wUHJvcGFnYXRpb24oKTtcclxuICAgIGlmIChcclxuICAgICAgcHJvamVjdFN0YXRlLmN1cnJlbnREcmFnZ2FibGUgJiZcclxuICAgICAgdGhpcy50eXBlICE9PSBwcm9qZWN0U3RhdGUuY3VycmVudERyYWdnYWJsZS5zdGF0dXNcclxuICAgICkge1xyXG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG59XHJcblxyXG4iLCJpbXBvcnQge1Byb2plY3RJbnB1dH0gZnJvbSBcIi4vY29tcG9uZW50cy9wcm9qZWN0LWlucHV0XCI7XHJcbmltcG9ydCB7UHJvamVjdExpc3R9IGZyb20gXCIuL2NvbXBvbmVudHMvcHJvamVjdC1saXN0XCI7XHJcbmltcG9ydCB7UHJvamVjdFN0YXR1c30gZnJvbSBcIi4vbW9kZWxzL3Byb2plY3RcIjtcclxuXHJcblxyXG5jb25zdCBwcm9qZWN0SW5wdXQgPSBuZXcgUHJvamVjdElucHV0KCk7XHJcbmNvbnN0IGFjdGl2ZVByb2plY3RzTGlzdCA9IG5ldyBQcm9qZWN0TGlzdChQcm9qZWN0U3RhdHVzLkFjdGl2ZSk7XHJcbmNvbnN0IGZpbmlzaGVkUHJvamVjdHNMaXN0ID0gbmV3IFByb2plY3RMaXN0KFByb2plY3RTdGF0dXMuRmluaXNoZWQpO1xyXG5cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==